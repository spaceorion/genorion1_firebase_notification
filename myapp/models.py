
from django.core.validators import MinValueValidator, MaxValueValidator
from django.db import models
from django.db.models.fields import CharField, EmailField
# from embed_video.fields import EmbedVideoField
from rest_framework import serializers
from django.conf import settings
from django.db.models.signals import post_save
from django.dispatch import receiver
from rest_framework.authtoken.models import Token
from django.contrib.auth.models import User
from django.core.validators import RegexValidator
import math, random
import requests
import os
from rest_framework.decorators import action
from twilio.rest import Client, TwilioIpMessagingClient
from myapp.utils import create_new_ref_number, dt, otplogin, defprofoto
from datetime import date
# User._meta.get_field('email')._unique = True
from django.core.management.base import BaseCommand, CommandError
# from cus_leads.models import CustomerLeads 
from datetime import datetime, timedelta

    


device_categories = (
    (1, u'Fan'),
    (2, u'Light'),
    (3, u'Plug'),
    (4, u'TV'),
    (5, u'Gyeser'),
    (6, u'Others'),
    # (7, u'')
)


smart_device = (
    (1, u'Yes'),
    (2, u'No'),
)


class place(models.Model):
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    p_id = models.CharField(max_length = 10,blank=False,unique=True,primary_key=True,default=create_new_ref_number)
    p_type = models.CharField(max_length=15)

class floor(models.Model):
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    p_id = models.ForeignKey(place, max_length=10, null=False, default=1,on_delete=models.CASCADE)
    f_id = models.CharField(max_length = 10, blank=False,unique=True,primary_key=True,default=create_new_ref_number)
    f_name = models.CharField(max_length=15)

class flat(models.Model):
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    f_id = models.ForeignKey(floor, max_length=10, null=False, default=1,on_delete=models.CASCADE)
    flt_id = models.CharField(max_length = 10, blank=False,unique=True,primary_key=True,default=create_new_ref_number)
    flt_name = models.CharField(max_length=15)
    

class room(models.Model):
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    flt_id = models.ForeignKey(flat, max_length=10, null=False, default=1, on_delete=models.CASCADE)
    r_id = models.CharField(max_length = 10,blank=False,unique=True,primary_key=True,default=create_new_ref_number)
    r_name = models.CharField(max_length=15)

class allDevices(models.Model):
    d_id = models.CharField(max_length=40, default=0,primary_key=True)
   
class device(models.Model):
    user=models.ForeignKey(User,on_delete=models.CASCADE)
    r_id = models.ForeignKey(room, on_delete=models.CASCADE)
    d_id = models.OneToOneField(allDevices, on_delete=models.CASCADE)
    date_installed = models.DateField(default=dt)

class deviceStatus(models.Model):
    d_id = models.OneToOneField(allDevices, on_delete=models.CASCADE,primary_key=True)
    pin1Status = models.IntegerField(blank=True,null=True,default=0)
    pin2Status = models.IntegerField(blank=True,null=True,default=0)
    pin3Status = models.IntegerField(blank=True,null=True,default=0)
    pin4Status = models.IntegerField(blank=True,null=True,default=0)
    pin5Status = models.IntegerField(blank=True,null=True,default=0)
    pin6Status = models.IntegerField(blank=True,null=True,default=0)
    pin7Status = models.IntegerField(blank=True,null=True,default=0)
    pin8Status = models.IntegerField(blank=True,null=True,default=0)
    pin9Status = models.IntegerField(blank=True,null=True,default=0)
    pin10Status = models.IntegerField(blank=True,null=True,default=0)
    pin11Status = models.IntegerField(blank=True,null=True,default=0)
    pin12Status = models.IntegerField(blank=True,null=True,default=0)
    pin13Status = models.IntegerField(blank=True,null=True,default=0)
    pin14Status = models.IntegerField(blank=True,null=True,default=0)
    pin15Status = models.IntegerField(blank=True,null=True,default=0)
    pin16Status = models.IntegerField(blank=True,null=True,default=0)
    pin17Status = models.BigIntegerField(blank=True,null=True,default=0)
    pin18Status = models.IntegerField(blank=True,null=True,default=0)
    pin19Status = models.CharField(blank=True,null=True,max_length=100,default=0)
    pin20Status = models.CharField(blank=True,null=True,max_length=100,default=0)

    sensor1 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor2 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor3 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor4 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor5 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor6 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor7 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor8 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor9 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor10 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
class sensors(models.Model):
    d_id = models.OneToOneField(allDevices, on_delete=models.CASCADE,primary_key=True)
    sensor1 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor2 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor3 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor4 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor5 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor6 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor7 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor8 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor9 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)
    sensor10 = models.FloatField(unique = False, max_length=50,default=0.0, blank=True)

class ssidPassword(models.Model):
    d_id = models.OneToOneField(allDevices, on_delete=models.CASCADE,primary_key=True)
    ssid1 = models.CharField(unique=True, max_length=15,blank=True)
    password1 = models.CharField(null=False, max_length=50,blank=True)
    ssid2 = models.CharField(unique=True, max_length=15,blank=True)
    password2 = models.CharField(null=False, max_length=50,blank=True)
    ssid3 = models.CharField(unique=True, max_length=15,blank=True)
    password3 = models.CharField(null=False, max_length=50,blank=True)

class emergencyNumber(models.Model):
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    d_id = models.OneToOneField(allDevices, on_delete=models.CASCADE,primary_key=True)
    number1 = models.CharField(null=True, max_length=12)
    number2 = models.CharField(null=True, max_length=12)
    number3 = models.CharField(null=True, max_length=12)
    number4 = models.CharField(null=True, max_length=12)
    number5 = models.CharField(null=True, max_length=12)

class pinName(models.Model):
    d_id = models.OneToOneField(allDevices, on_delete=models.CASCADE,primary_key=True)
    pin1Name = models.CharField(blank=True,null=True,max_length=20,default='Device1,001')
    pin2Name = models.CharField(blank=True,null=True,max_length=20,default='Device2,001')
    pin3Name = models.CharField(blank=True,null=True,max_length=20,default='Device3,001')
    pin4Name = models.CharField(blank=True,null=True,max_length=20,default='Device4,001')
    pin5Name = models.CharField(blank=True,null=True,max_length=20,default='Device5,001')
    pin6Name = models.CharField(blank=True,null=True,max_length=20,default='Device6,001')
    pin7Name = models.CharField(blank=True,null=True,max_length=20,default='Device7,001')
    pin8Name = models.CharField(blank=True,null=True,max_length=20,default='Device8,001')
    pin9Name = models.CharField(blank=True,null=True,max_length=20,default='Device9,001')
    pin10Name = models.CharField(blank=True,null=True,max_length=20,default='Device10,001')
    pin11Name = models.CharField(blank=True,null=True,max_length=20,default='Device11,001')
    pin12Name = models.CharField(blank=True,null=True,max_length=20,default='Device12,001')
    pin13Name = models.CharField(blank=True,null=True,max_length=20,default='Device13,001')
    pin14Name = models.CharField(blank=True,null=True,max_length=20,default='Device14,001')
    pin15Name = models.CharField(blank=True,null=True,max_length=20,default='Device15,001')
    pin16Name = models.CharField(blank=True,null=True,max_length=20,default='Device16,001')
    pin17Name = models.CharField(blank=True,null=True,max_length=20,default='Device17,001')
    pin18Name = models.CharField(blank=True,null=True,max_length=20,default='Device18,001')
    pin19Name = models.CharField(blank=True,null=True,max_length=20,default='Device19,001')
    pin20Name = models.CharField(blank=True,null=True,max_length=20,default='Device20,001')


class pinschedule(models.Model):
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    d_id = models.ForeignKey(allDevices, on_delete=models.CASCADE)
    date1 = models.DateField(default="2000-01-01",null=True)
    timing1 = models.TimeField(default='00:00')
    pin1Status = models.IntegerField(blank=True,null=True)
    pin2Status = models.IntegerField(blank=True,null=True)
    pin3Status = models.IntegerField(blank=True,null=True)
    pin4Status = models.IntegerField(blank=True,null=True)
    pin5Status = models.IntegerField(blank=True,null=True)
    pin6Status = models.IntegerField(blank=True,null=True)
    pin7Status = models.IntegerField(blank=True,null=True)
    pin8Status = models.IntegerField(blank=True,null=True)
    pin9Status = models.IntegerField(blank=True,null=True)
    pin10Status = models.IntegerField(blank=True,null=True)
    pin11Status = models.IntegerField(blank=True,null=True)
    pin12Status = models.IntegerField(blank=True,null=True)
    pin13Status = models.IntegerField(blank=True,null=True)
    pin14Status = models.IntegerField(blank=True,null=True)
    pin15Status = models.IntegerField(blank=True,null=True)
    pin16Status = models.IntegerField(blank=True,null=True)
    pin17Status = models.BigIntegerField(blank=True,null=True)
    pin18Status = models.IntegerField(blank=True,null=True)
    pin19Status = models.CharField(blank=True,null=True,max_length=100)
    pin20Status = models.CharField(blank=True,null=True,max_length=100)


    # def handle(self, *args, **options):
    #     today = date.today()
    #     now = datetime.now()
    #     d1 = today.strftime("%Y-%m-%d")
    #     d2 = now.strftime("%H:%M")
    #     pinschedule.objects.filter(date1=d1,timing1=d2).delete()
    #     self.stdout.write('Deleted objects in time')
   

class userimages(models.Model):
    user = models.OneToOneField(User, on_delete=models.CASCADE,primary_key=True)
    images = models.ImageField(upload_to='profile_picture', blank=True)

    
class subuseraccess(models.Model):
    # user = models.ForeignKey(User, on_delete=models.CASCADE)
    emailtest = EmailField()
    email = models.CharField(primary_key=True, max_length=100)

class subuserplace(models.Model):
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    owner_name = models.CharField(max_length=20, blank=True)
    name = models.CharField(max_length=100, blank=False)
    email = models.ForeignKey(subuseraccess, on_delete=models.CASCADE)
    p_id = models.ForeignKey(place, on_delete=models.CASCADE)

class SomeModel(models.Model):
    user = models.OneToOneField(User, on_delete=models.CASCADE,primary_key=True)
    file = models.CharField(max_length=499999, blank=True, default=defprofoto())

class deviceIpAddress(models.Model):
    d_id = models.OneToOneField(allDevices, on_delete=models.CASCADE,primary_key=True)
    ipaddress = models.CharField(max_length=99,blank=True,null=True)

# class Profile(models.Model):
#     # user = models.OneToOneField(User ,on_delete=models.CASCADE)
#     mobile = models.CharField(max_length=20)
#     otp = models.CharField(max_length=6)


# API for main user include all the parameters while creating new temporary user
# API for temporary user include only mobile or email with place, floor, room, device ID's

class tempuser(models.Model):
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    owner_name = models.CharField(max_length=20, blank=True)
    mobile = models.CharField(max_length=10, blank=True)
    email = EmailField(blank=True)
    name = models.CharField(max_length=100,blank=False)
    date = models.DateField(default="2000-01-01",null=True)
    timing = models.CharField(max_length=200,default='00:00')
    p_id = models.ForeignKey(place, on_delete=models.CASCADE, blank=True, null=True)
    f_id = models.ForeignKey(floor, on_delete=models.CASCADE, blank=True, null=True)
    flt_id = models.ForeignKey(flat, on_delete=models.CASCADE, blank=True, null=True)
    r_id = models.ForeignKey(room, on_delete=models.CASCADE, blank=True, null=True)
    d_id = models.ForeignKey(allDevices, on_delete=models.CASCADE, blank=True, null=True)

class tempUserVerification(models.Model):
    mobile = models.CharField(max_length=10, blank=False)
    # updated_date = models.DateField(auto_now_add=True)
    # updated_time = models.TimeField(auto_now=True,editable=True)
    otp = models.CharField(max_length=6, default=otplogin, blank=True)    

class otptemplogin(models.Model):
    mobile = models.CharField(max_length=10, blank=False)
    otp = models.CharField(max_length=6, blank=False)

class energy(models.Model):
    d_id = models.OneToOneField(allDevices, on_delete=models.CASCADE,primary_key=True)
    # datee = models.DateField(default="2000-01-01",null=True)
    # timinge = models.TimeField(default='00:00')
    enrgy10 = models.CharField(max_length=50, blank=True, null=True, default=0)
    enrgy20 = models.CharField(max_length=50, blank=True, null=True, default=0)
    enrgy30 = models.CharField(max_length=50, blank=True, null=True, default=0)
    enrgy40 = models.CharField(max_length=50, blank=True, null=True, default=0)
    enrgy50 = models.CharField(max_length=50, blank=True, null=True, default=0)
    enrgy60 = models.CharField(max_length=50, blank=True, null=True, default=0)

class oneHourEnergy(models.Model):
    d_id = models.CharField(max_length=50, primary_key=True)
    hour1 = models.CharField(default=0, blank=True, max_length=10)
    hour2 = models.CharField(default=0, blank=True, max_length=10)
    hour3 = models.CharField(default=0, blank=True, max_length=10)
    hour4 = models.CharField(default=0, blank=True, max_length=10)
    hour5 = models.CharField(default=0, blank=True, max_length=10)
    hour6 = models.CharField(default=0, blank=True, max_length=10)
    hour7 = models.CharField(default=0, blank=True, max_length=10)
    hour8 = models.CharField(default=0, blank=True, max_length=10)
    hour9 = models.CharField(default=0, blank=True, max_length=10)
    hour10 = models.CharField(default=0, blank=True, max_length=10)
    hour11 = models.CharField(default=0, blank=True, max_length=10)
    hour12 = models.CharField(default=0, blank=True, max_length=10)
    hour13 = models.CharField(default=0, blank=True, max_length=10)
    hour14 = models.CharField(default=0, blank=True, max_length=10)
    hour15 = models.CharField(default=0, blank=True, max_length=10)
    hour16 = models.CharField(default=0, blank=True, max_length=10)
    hour17 = models.CharField(default=0, blank=True, max_length=10)
    hour18 = models.CharField(default=0, blank=True, max_length=10)
    hour19 = models.CharField(default=0, blank=True, max_length=10)
    hour20 = models.CharField(default=0, blank=True, max_length=10)
    hour21 = models.CharField(default=0, blank=True, max_length=10)
    hour22 = models.CharField(default=0, blank=True, max_length=10)
    hour23 = models.CharField(default=0, blank=True, max_length=10)
    hour24 = models.CharField(default=0, blank=True, max_length=10)

class oneyeardata(models.Model):
    d_id = models.CharField(max_length=50, primary_key=True)
    day1 = models.FloatField(max_length=20, blank=True, null=True)
    day2 = models.FloatField(max_length=20, blank=True, null=True)
    day3 = models.FloatField(max_length=20, blank=True, null=True)
    day4 = models.FloatField(max_length=20, blank=True, null=True)
    day5 = models.FloatField(max_length=20, blank=True, null=True)
    day6 = models.FloatField(max_length=20, blank=True, null=True)
    day7 = models.FloatField(max_length=20, blank=True, null=True)
    day8 = models.FloatField(max_length=20, blank=True, null=True)
    day9 = models.FloatField(max_length=20, blank=True, null=True)
    day10 = models.FloatField(max_length=20, blank=True, null=True)
    day11 = models.FloatField(max_length=20, blank=True, null=True)
    day12 = models.FloatField(max_length=20, blank=True, null=True)
    day13 = models.FloatField(max_length=20, blank=True, null=True)
    day14 = models.FloatField(max_length=20, blank=True, null=True)
    day15 = models.FloatField(max_length=20, blank=True, null=True)
    day16 = models.FloatField(max_length=20, blank=True, null=True)
    day17 = models.FloatField(max_length=20, blank=True, null=True)
    day18 = models.FloatField(max_length=20, blank=True, null=True)
    day19 = models.FloatField(max_length=20, blank=True, null=True)
    day20 = models.FloatField(max_length=20, blank=True, null=True)
    day21 = models.FloatField(max_length=20, blank=True, null=True)
    day22 = models.FloatField(max_length=20, blank=True, null=True)
    day23 = models.FloatField(max_length=20, blank=True, null=True)
    day24 = models.FloatField(max_length=20, blank=True, null=True)
    day25 = models.FloatField(max_length=20, blank=True, null=True)
    day26 = models.FloatField(max_length=20, blank=True, null=True)
    day27 = models.FloatField(max_length=20, blank=True, null=True)
    day28 = models.FloatField(max_length=20, blank=True, null=True)
    day29 = models.FloatField(max_length=20, blank=True, null=True)
    day30 = models.FloatField(max_length=20, blank=True, null=True)
    day31 = models.FloatField(max_length=20, blank=True, null=True)
    day32 = models.FloatField(max_length=20, blank=True, null=True)
    day33 = models.FloatField(max_length=20, blank=True, null=True)
    day34 = models.FloatField(max_length=20, blank=True, null=True)
    day35 = models.FloatField(max_length=20, blank=True, null=True)
    day36 = models.FloatField(max_length=20, blank=True, null=True)
    day37 = models.FloatField(max_length=20, blank=True, null=True)
    day38 = models.FloatField(max_length=20, blank=True, null=True)
    day39 = models.FloatField(max_length=20, blank=True, null=True)
    day40 = models.FloatField(max_length=20, blank=True, null=True)
    day41 = models.FloatField(max_length=20, blank=True, null=True)
    day42 = models.FloatField(max_length=20, blank=True, null=True)
    day43 = models.FloatField(max_length=20, blank=True, null=True)
    day44 = models.FloatField(max_length=20, blank=True, null=True)
    day45 = models.FloatField(max_length=20, blank=True, null=True)
    day46 = models.FloatField(max_length=20, blank=True, null=True)
    day47 = models.FloatField(max_length=20, blank=True, null=True)
    day48 = models.FloatField(max_length=20, blank=True, null=True)
    day49 = models.FloatField(max_length=20, blank=True, null=True)
    day50 = models.FloatField(max_length=20, blank=True, null=True)
    day51 = models.FloatField(max_length=20, blank=True, null=True)
    day52 = models.FloatField(max_length=20, blank=True, null=True)
    day53 = models.FloatField(max_length=20, blank=True, null=True)
    day54 = models.FloatField(max_length=20, blank=True, null=True)
    day55 = models.FloatField(max_length=20, blank=True, null=True)
    day56 = models.FloatField(max_length=20, blank=True, null=True)
    day57 = models.FloatField(max_length=20, blank=True, null=True)
    day58 = models.FloatField(max_length=20, blank=True, null=True)
    day59 = models.FloatField(max_length=20, blank=True, null=True)
    day60 = models.FloatField(max_length=20, blank=True, null=True)
    day61 = models.FloatField(max_length=20, blank=True, null=True)
    day62 = models.FloatField(max_length=20, blank=True, null=True)
    day63 = models.FloatField(max_length=20, blank=True, null=True)
    day64 = models.FloatField(max_length=20, blank=True, null=True)
    day65 = models.FloatField(max_length=20, blank=True, null=True)
    day66 = models.FloatField(max_length=20, blank=True, null=True)
    day67 = models.FloatField(max_length=20, blank=True, null=True)
    day68 = models.FloatField(max_length=20, blank=True, null=True)
    day69 = models.FloatField(max_length=20, blank=True, null=True)
    day70 = models.FloatField(max_length=20, blank=True, null=True)
    day71 = models.FloatField(max_length=20, blank=True, null=True)
    day72 = models.FloatField(max_length=20, blank=True, null=True)
    day73 = models.FloatField(max_length=20, blank=True, null=True)
    day74 = models.FloatField(max_length=20, blank=True, null=True)
    day75 = models.FloatField(max_length=20, blank=True, null=True)
    day76 = models.FloatField(max_length=20, blank=True, null=True)
    day77 = models.FloatField(max_length=20, blank=True, null=True)
    day78 = models.FloatField(max_length=20, blank=True, null=True)
    day79 = models.FloatField(max_length=20, blank=True, null=True)
    day80 = models.FloatField(max_length=20, blank=True, null=True)
    day81 = models.FloatField(max_length=20, blank=True, null=True)
    day82 = models.FloatField(max_length=20, blank=True, null=True)
    day83 = models.FloatField(max_length=20, blank=True, null=True)
    day84 = models.FloatField(max_length=20, blank=True, null=True)
    day85 = models.FloatField(max_length=20, blank=True, null=True)
    day86 = models.FloatField(max_length=20, blank=True, null=True)
    day87 = models.FloatField(max_length=20, blank=True, null=True)
    day88 = models.FloatField(max_length=20, blank=True, null=True)
    day89 = models.FloatField(max_length=20, blank=True, null=True)
    day90 = models.FloatField(max_length=20, blank=True, null=True)
    day91 = models.FloatField(max_length=20, blank=True, null=True)
    day92 = models.FloatField(max_length=20, blank=True, null=True)
    day93 = models.FloatField(max_length=20, blank=True, null=True)
    day94 = models.FloatField(max_length=20, blank=True, null=True)
    day95 = models.FloatField(max_length=20, blank=True, null=True)
    day96 = models.FloatField(max_length=20, blank=True, null=True)
    day97 = models.FloatField(max_length=20, blank=True, null=True)
    day98 = models.FloatField(max_length=20, blank=True, null=True)
    day99 = models.FloatField(max_length=20, blank=True, null=True)
    day100 = models.FloatField(max_length=20, blank=True, null=True)
    day101 = models.FloatField(max_length=20, blank=True, null=True)
    day102 = models.FloatField(max_length=20, blank=True, null=True)
    day103 = models.FloatField(max_length=20, blank=True, null=True)
    day104 = models.FloatField(max_length=20, blank=True, null=True)
    day105 = models.FloatField(max_length=20, blank=True, null=True)
    day106 = models.FloatField(max_length=20, blank=True, null=True)
    day107 = models.FloatField(max_length=20, blank=True, null=True)
    day108 = models.FloatField(max_length=20, blank=True, null=True)
    day109 = models.FloatField(max_length=20, blank=True, null=True)
    day110 = models.FloatField(max_length=20, blank=True, null=True)
    day111 = models.FloatField(max_length=20, blank=True, null=True)
    day112 = models.FloatField(max_length=20, blank=True, null=True)
    day113 = models.FloatField(max_length=20, blank=True, null=True)
    day114 = models.FloatField(max_length=20, blank=True, null=True)
    day115 = models.FloatField(max_length=20, blank=True, null=True)
    day116 = models.FloatField(max_length=20, blank=True, null=True)
    day117 = models.FloatField(max_length=20, blank=True, null=True)
    day118 = models.FloatField(max_length=20, blank=True, null=True)
    day119 = models.FloatField(max_length=20, blank=True, null=True)
    day120 = models.FloatField(max_length=20, blank=True, null=True)
    day121 = models.FloatField(max_length=20, blank=True, null=True)
    day122 = models.FloatField(max_length=20, blank=True, null=True)
    day123 = models.FloatField(max_length=20, blank=True, null=True)
    day124 = models.FloatField(max_length=20, blank=True, null=True)
    day125 = models.FloatField(max_length=20, blank=True, null=True)
    day126 = models.FloatField(max_length=20, blank=True, null=True)
    day127 = models.FloatField(max_length=20, blank=True, null=True)
    day128 = models.FloatField(max_length=20, blank=True, null=True)
    day129 = models.FloatField(max_length=20, blank=True, null=True)
    day130 = models.FloatField(max_length=20, blank=True, null=True)
    day131 = models.FloatField(max_length=20, blank=True, null=True)
    day132 = models.FloatField(max_length=20, blank=True, null=True)
    day133 = models.FloatField(max_length=20, blank=True, null=True)
    day134 = models.FloatField(max_length=20, blank=True, null=True)
    day135 = models.FloatField(max_length=20, blank=True, null=True)
    day136 = models.FloatField(max_length=20, blank=True, null=True)
    day137 = models.FloatField(max_length=20, blank=True, null=True)
    day138 = models.FloatField(max_length=20, blank=True, null=True)
    day139 = models.FloatField(max_length=20, blank=True, null=True)
    day140 = models.FloatField(max_length=20, blank=True, null=True)
    day141 = models.FloatField(max_length=20, blank=True, null=True)
    day142 = models.FloatField(max_length=20, blank=True, null=True)
    day143 = models.FloatField(max_length=20, blank=True, null=True)
    day144 = models.FloatField(max_length=20, blank=True, null=True)
    day145 = models.FloatField(max_length=20, blank=True, null=True)
    day146 = models.FloatField(max_length=20, blank=True, null=True)
    day147 = models.FloatField(max_length=20, blank=True, null=True)
    day148 = models.FloatField(max_length=20, blank=True, null=True)
    day149 = models.FloatField(max_length=20, blank=True, null=True)
    day150 = models.FloatField(max_length=20, blank=True, null=True)
    day151 = models.FloatField(max_length=20, blank=True, null=True)
    day152 = models.FloatField(max_length=20, blank=True, null=True)
    day153 = models.FloatField(max_length=20, blank=True, null=True)
    day154 = models.FloatField(max_length=20, blank=True, null=True)
    day155 = models.FloatField(max_length=20, blank=True, null=True)
    day156 = models.FloatField(max_length=20, blank=True, null=True)
    day157 = models.FloatField(max_length=20, blank=True, null=True)
    day158 = models.FloatField(max_length=20, blank=True, null=True)
    day159 = models.FloatField(max_length=20, blank=True, null=True)
    day160 = models.FloatField(max_length=20, blank=True, null=True)
    day161 = models.FloatField(max_length=20, blank=True, null=True)
    day162 = models.FloatField(max_length=20, blank=True, null=True)
    day163 = models.FloatField(max_length=20, blank=True, null=True)
    day164 = models.FloatField(max_length=20, blank=True, null=True)
    day165 = models.FloatField(max_length=20, blank=True, null=True)
    day166 = models.FloatField(max_length=20, blank=True, null=True)
    day167 = models.FloatField(max_length=20, blank=True, null=True)
    day168 = models.FloatField(max_length=20, blank=True, null=True)
    day169 = models.FloatField(max_length=20, blank=True, null=True)
    day170 = models.FloatField(max_length=20, blank=True, null=True)
    day171 = models.FloatField(max_length=20, blank=True, null=True)
    day172 = models.FloatField(max_length=20, blank=True, null=True)
    day173 = models.FloatField(max_length=20, blank=True, null=True)
    day174 = models.FloatField(max_length=20, blank=True, null=True)
    day175 = models.FloatField(max_length=20, blank=True, null=True)
    day176 = models.FloatField(max_length=20, blank=True, null=True)
    day177 = models.FloatField(max_length=20, blank=True, null=True)
    day178 = models.FloatField(max_length=20, blank=True, null=True)
    day179 = models.FloatField(max_length=20, blank=True, null=True)
    day180 = models.FloatField(max_length=20, blank=True, null=True)
    day181 = models.FloatField(max_length=20, blank=True, null=True)
    day182 = models.FloatField(max_length=20, blank=True, null=True)
    day183 = models.FloatField(max_length=20, blank=True, null=True)
    day184 = models.FloatField(max_length=20, blank=True, null=True)
    day185 = models.FloatField(max_length=20, blank=True, null=True)
    day186 = models.FloatField(max_length=20, blank=True, null=True)
    day187 = models.FloatField(max_length=20, blank=True, null=True)
    day188 = models.FloatField(max_length=20, blank=True, null=True)
    day189 = models.FloatField(max_length=20, blank=True, null=True)
    day190 = models.FloatField(max_length=20, blank=True, null=True)
    day191 = models.FloatField(max_length=20, blank=True, null=True)
    day192 = models.FloatField(max_length=20, blank=True, null=True)
    day193 = models.FloatField(max_length=20, blank=True, null=True)
    day194 = models.FloatField(max_length=20, blank=True, null=True)
    day195 = models.FloatField(max_length=20, blank=True, null=True)
    day196 = models.FloatField(max_length=20, blank=True, null=True)
    day197 = models.FloatField(max_length=20, blank=True, null=True)
    day198 = models.FloatField(max_length=20, blank=True, null=True)
    day199 = models.FloatField(max_length=20, blank=True, null=True)
    day200 = models.FloatField(max_length=20, blank=True, null=True)
    day201 = models.FloatField(max_length=20, blank=True, null=True)
    day202 = models.FloatField(max_length=20, blank=True, null=True)
    day203 = models.FloatField(max_length=20, blank=True, null=True)
    day204 = models.FloatField(max_length=20, blank=True, null=True)
    day205 = models.FloatField(max_length=20, blank=True, null=True)
    day206 = models.FloatField(max_length=20, blank=True, null=True)
    day207 = models.FloatField(max_length=20, blank=True, null=True)
    day208 = models.FloatField(max_length=20, blank=True, null=True)
    day209 = models.FloatField(max_length=20, blank=True, null=True)
    day210 = models.FloatField(max_length=20, blank=True, null=True)
    day211 = models.FloatField(max_length=20, blank=True, null=True)
    day212 = models.FloatField(max_length=20, blank=True, null=True)
    day213 = models.FloatField(max_length=20, blank=True, null=True)
    day214 = models.FloatField(max_length=20, blank=True, null=True)
    day215 = models.FloatField(max_length=20, blank=True, null=True)
    day216 = models.FloatField(max_length=20, blank=True, null=True)
    day217 = models.FloatField(max_length=20, blank=True, null=True)
    day218 = models.FloatField(max_length=20, blank=True, null=True)
    day219 = models.FloatField(max_length=20, blank=True, null=True)
    day220 = models.FloatField(max_length=20, blank=True, null=True)
    day221 = models.FloatField(max_length=20, blank=True, null=True)
    day222 = models.FloatField(max_length=20, blank=True, null=True)
    day223 = models.FloatField(max_length=20, blank=True, null=True)
    day224 = models.FloatField(max_length=20, blank=True, null=True)
    day225 = models.FloatField(max_length=20, blank=True, null=True)
    day226 = models.FloatField(max_length=20, blank=True, null=True)
    day227 = models.FloatField(max_length=20, blank=True, null=True)
    day228 = models.FloatField(max_length=20, blank=True, null=True)
    day229 = models.FloatField(max_length=20, blank=True, null=True)
    day230 = models.FloatField(max_length=20, blank=True, null=True)
    day231 = models.FloatField(max_length=20, blank=True, null=True)
    day232 = models.FloatField(max_length=20, blank=True, null=True)
    day233 = models.FloatField(max_length=20, blank=True, null=True)
    day234 = models.FloatField(max_length=20, blank=True, null=True)
    day235 = models.FloatField(max_length=20, blank=True, null=True)
    day236 = models.FloatField(max_length=20, blank=True, null=True)
    day237 = models.FloatField(max_length=20, blank=True, null=True)
    day238 = models.FloatField(max_length=20, blank=True, null=True)
    day239 = models.FloatField(max_length=20, blank=True, null=True)
    day240 = models.FloatField(max_length=20, blank=True, null=True)
    day241 = models.FloatField(max_length=20, blank=True, null=True)
    day242 = models.FloatField(max_length=20, blank=True, null=True)
    day243 = models.FloatField(max_length=20, blank=True, null=True)
    day244 = models.FloatField(max_length=20, blank=True, null=True)
    day245 = models.FloatField(max_length=20, blank=True, null=True)
    day246 = models.FloatField(max_length=20, blank=True, null=True)
    day247 = models.FloatField(max_length=20, blank=True, null=True)
    day248 = models.FloatField(max_length=20, blank=True, null=True)
    day249 = models.FloatField(max_length=20, blank=True, null=True)
    day250 = models.FloatField(max_length=20, blank=True, null=True)
    day251 = models.FloatField(max_length=20, blank=True, null=True)
    day252 = models.FloatField(max_length=20, blank=True, null=True)
    day253 = models.FloatField(max_length=20, blank=True, null=True)
    day254 = models.FloatField(max_length=20, blank=True, null=True)
    day255 = models.FloatField(max_length=20, blank=True, null=True)
    day256 = models.FloatField(max_length=20, blank=True, null=True)
    day257 = models.FloatField(max_length=20, blank=True, null=True)
    day258 = models.FloatField(max_length=20, blank=True, null=True)
    day259 = models.FloatField(max_length=20, blank=True, null=True)
    day260 = models.FloatField(max_length=20, blank=True, null=True)
    day261 = models.FloatField(max_length=20, blank=True, null=True)
    day262 = models.FloatField(max_length=20, blank=True, null=True)
    day263 = models.FloatField(max_length=20, blank=True, null=True)
    day264 = models.FloatField(max_length=20, blank=True, null=True)
    day265 = models.FloatField(max_length=20, blank=True, null=True)
    day266 = models.FloatField(max_length=20, blank=True, null=True)
    day267 = models.FloatField(max_length=20, blank=True, null=True)
    day268 = models.FloatField(max_length=20, blank=True, null=True)
    day269 = models.FloatField(max_length=20, blank=True, null=True)
    day270 = models.FloatField(max_length=20, blank=True, null=True)
    day271 = models.FloatField(max_length=20, blank=True, null=True)
    day272 = models.FloatField(max_length=20, blank=True, null=True)
    day273 = models.FloatField(max_length=20, blank=True, null=True)
    day274 = models.FloatField(max_length=20, blank=True, null=True)
    day275 = models.FloatField(max_length=20, blank=True, null=True)
    day276 = models.FloatField(max_length=20, blank=True, null=True)
    day277 = models.FloatField(max_length=20, blank=True, null=True)
    day278 = models.FloatField(max_length=20, blank=True, null=True)
    day279 = models.FloatField(max_length=20, blank=True, null=True)
    day280 = models.FloatField(max_length=20, blank=True, null=True)
    day281 = models.FloatField(max_length=20, blank=True, null=True)
    day282 = models.FloatField(max_length=20, blank=True, null=True)
    day283 = models.FloatField(max_length=20, blank=True, null=True)
    day284 = models.FloatField(max_length=20, blank=True, null=True)
    day285 = models.FloatField(max_length=20, blank=True, null=True)
    day286 = models.FloatField(max_length=20, blank=True, null=True)
    day287 = models.FloatField(max_length=20, blank=True, null=True)
    day288 = models.FloatField(max_length=20, blank=True, null=True)
    day289 = models.FloatField(max_length=20, blank=True, null=True)
    day290 = models.FloatField(max_length=20, blank=True, null=True)
    day291 = models.FloatField(max_length=20, blank=True, null=True)
    day292 = models.FloatField(max_length=20, blank=True, null=True)
    day293 = models.FloatField(max_length=20, blank=True, null=True)
    day294 = models.FloatField(max_length=20, blank=True, null=True)
    day295 = models.FloatField(max_length=20, blank=True, null=True)
    day296 = models.FloatField(max_length=20, blank=True, null=True)
    day297 = models.FloatField(max_length=20, blank=True, null=True)
    day298 = models.FloatField(max_length=20, blank=True, null=True)
    day299 = models.FloatField(max_length=20, blank=True, null=True)
    day300 = models.FloatField(max_length=20, blank=True, null=True)
    day301 = models.FloatField(max_length=20, blank=True, null=True)
    day302 = models.FloatField(max_length=20, blank=True, null=True)
    day303 = models.FloatField(max_length=20, blank=True, null=True)
    day304 = models.FloatField(max_length=20, blank=True, null=True)
    day305 = models.FloatField(max_length=20, blank=True, null=True)
    day306 = models.FloatField(max_length=20, blank=True, null=True)
    day307 = models.FloatField(max_length=20, blank=True, null=True)
    day308 = models.FloatField(max_length=20, blank=True, null=True)
    day309 = models.FloatField(max_length=20, blank=True, null=True)
    day310 = models.FloatField(max_length=20, blank=True, null=True)
    day311 = models.FloatField(max_length=20, blank=True, null=True)
    day312 = models.FloatField(max_length=20, blank=True, null=True)
    day313 = models.FloatField(max_length=20, blank=True, null=True)
    day314 = models.FloatField(max_length=20, blank=True, null=True)
    day315 = models.FloatField(max_length=20, blank=True, null=True)
    day316 = models.FloatField(max_length=20, blank=True, null=True)
    day317 = models.FloatField(max_length=20, blank=True, null=True)
    day318 = models.FloatField(max_length=20, blank=True, null=True)
    day319 = models.FloatField(max_length=20, blank=True, null=True)
    day320 = models.FloatField(max_length=20, blank=True, null=True)
    day321 = models.FloatField(max_length=20, blank=True, null=True)
    day322 = models.FloatField(max_length=20, blank=True, null=True)
    day323 = models.FloatField(max_length=20, blank=True, null=True)
    day324 = models.FloatField(max_length=20, blank=True, null=True)
    day325 = models.FloatField(max_length=20, blank=True, null=True)
    day326 = models.FloatField(max_length=20, blank=True, null=True)
    day327 = models.FloatField(max_length=20, blank=True, null=True)
    day328 = models.FloatField(max_length=20, blank=True, null=True)
    day329 = models.FloatField(max_length=20, blank=True, null=True)
    day330 = models.FloatField(max_length=20, blank=True, null=True)
    day331 = models.FloatField(max_length=20, blank=True, null=True)
    day332 = models.FloatField(max_length=20, blank=True, null=True)
    day333 = models.FloatField(max_length=20, blank=True, null=True)
    day334 = models.FloatField(max_length=20, blank=True, null=True)
    day335 = models.FloatField(max_length=20, blank=True, null=True)
    day336 = models.FloatField(max_length=20, blank=True, null=True)
    day337 = models.FloatField(max_length=20, blank=True, null=True)
    day338 = models.FloatField(max_length=20, blank=True, null=True)
    day339 = models.FloatField(max_length=20, blank=True, null=True)
    day340 = models.FloatField(max_length=20, blank=True, null=True)
    day341 = models.FloatField(max_length=20, blank=True, null=True)
    day342 = models.FloatField(max_length=20, blank=True, null=True)
    day343 = models.FloatField(max_length=20, blank=True, null=True)
    day344 = models.FloatField(max_length=20, blank=True, null=True)
    day345 = models.FloatField(max_length=20, blank=True, null=True)
    day346 = models.FloatField(max_length=20, blank=True, null=True)
    day347 = models.FloatField(max_length=20, blank=True, null=True)
    day348 = models.FloatField(max_length=20, blank=True, null=True)
    day349 = models.FloatField(max_length=20, blank=True, null=True)
    day350 = models.FloatField(max_length=20, blank=True, null=True)
    day351 = models.FloatField(max_length=20, blank=True, null=True)
    day352 = models.FloatField(max_length=20, blank=True, null=True)
    day353 = models.FloatField(max_length=20, blank=True, null=True)
    day354 = models.FloatField(max_length=20, blank=True, null=True)
    day355 = models.FloatField(max_length=20, blank=True, null=True)
    day356 = models.FloatField(max_length=20, blank=True, null=True)
    day357 = models.FloatField(max_length=20, blank=True, null=True)
    day358 = models.FloatField(max_length=20, blank=True, null=True)
    day359 = models.FloatField(max_length=20, blank=True, null=True)
    day360 = models.FloatField(max_length=20, blank=True, null=True)
    day361 = models.FloatField(max_length=20, blank=True, null=True)
    day362 = models.FloatField(max_length=20, blank=True, null=True)
    day363 = models.FloatField(max_length=20, blank=True, null=True)
    day364 = models.FloatField(max_length=20, blank=True, null=True)
    day365 = models.FloatField(max_length=20, blank=True, null=True)
    day366 = models.FloatField(max_length=20, blank=True, null=True)

class threeyears(models.Model):
    d_id = models.CharField(max_length=50, primary_key=True)
    year1 = models.CharField(max_length=50, blank=True)
    year2 = models.CharField(max_length=50, blank=True)
    year3 = models.CharField(max_length=50, blank=True)

class FirebaseDetails(models.Model):
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    d_id = models.OneToOneField(allDevices, on_delete=models.CASCADE,primary_key=True)
    fcm = models.TextField()
#####
# class scene(models.Model):
#     user = models.ForeignKey(User, on_delete=models.CASCADE)
#     scene_id = models.CharField(max_length = 10,blank=False,unique=True,primary_key=True,default=create_new_ref_number)
#     scene_type = models.CharField(max_length=15)
#     def __str__(self):
#         return  str (self.user)
# ###
# class scene_devices(models.Model):
   
#     scene_id = models.ForeignKey(scene, max_length=10, null=False, default=1,on_delete=models.CASCADE)
#     scenedevices_id = models.CharField(max_length = 10, blank=False,unique=True,primary_key=True,default=create_new_ref_number)
#     d_id = models.CharField(max_length=50 )
#     scene_device_type = models.CharField(max_length=15)
#     status = models.IntegerField(validators=[MinValueValidator(0),
#                                        MaxValueValidator(10)])
    
#     time = models.DateTimeField()
    
#     class Meta:
#         ordering = ('time',)
# class Videos(models.Model):
#     video = EmbedVideoField()
class scene(models.Model):
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    scene_id = models.CharField(max_length = 10,blank=False,unique=True,primary_key=True,default=create_new_ref_number)
    scene_type = models.CharField(max_length=15)
class scene_devices(models.Model):
    
    scene_id = models.ForeignKey(scene, max_length=10, null=False, default=1,on_delete=models.CASCADE)
    scenedevices_id = models.CharField(max_length = 10, blank=False,unique=True,primary_key=True,default=create_new_ref_number)
    d_id = models.CharField(max_length=15)
    scene_device_type = models.CharField(max_length=15)
    status = models.IntegerField(validators=[MinValueValidator(0),
                                       MaxValueValidator(10)])
    time = models.DateTimeField()
    
                                       
    

@receiver(post_save, sender=settings.AUTH_USER_MODEL)
def create_auth_token(sender, instance=None, created=False, **kwargs):
    if created:
        Token.objects.create(user=instance)
